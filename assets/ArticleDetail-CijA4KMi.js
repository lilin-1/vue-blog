import{_ as R}from"./avatar-CqVDRiVN.js";import{d as A,r as L,c as _,o as Z,D as P,k as m,j as t,F as T,s as B,t as Q,y as g,i as n,J as S,w as W,x as k,m as d,q as h,f as E,z as b,A as H,g as j,u as U}from"./vendor-BA1WIY61.js";import{t as V,_ as Y,u as J,m as O,f as N,c as F}from"./index-DTOcjxgb.js";import"./ui-9MHhjKhu.js";const q={key:0},K={class:"space-y-1"},X=["href","onClick"],tt={key:1,class:"text-sm text-gray-500 dark:text-gray-400"},et=A({__name:"TableOfContents",props:{content:{}},setup($){const C=$,I=L(""),u=_(()=>{const a=/^(#{1,6})\s+(.+)$/gm,l=[];let s;for(;(s=a.exec(C.content))!==null;){const x=s[1].length,c=s[2].trim(),y=o(c);l.push({id:y,text:c,level:x})}return l}),o=a=>a.toLowerCase().replace(/[^\w\u4e00-\u9fa5\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,""),M=a=>{const l=document.getElementById(a);if(l){const c=l.getBoundingClientRect().top+window.pageYOffset-100;window.scrollTo({top:c,behavior:"smooth"}),history.replaceState(null,"",`#${a}`)}},w=()=>{const a=window.scrollY+150;let l="";for(const s of u.value){const x=document.getElementById(s.id);if(x){const c=x.offsetTop;if(a>=c)l=s.id;else break}}I.value=l},v=V(w,100);return Z(()=>{setTimeout(()=>{const a=document.querySelector(".article-content");if(a&&a.querySelectorAll("h1, h2, h3, h4, h5, h6").forEach((s,x)=>{const c=u.value[x];if(c){s.id=c.id,s.classList.add("group","relative");const y=document.createElement("a");y.href=`#${c.id}`,y.className="absolute -left-6 top-0 opacity-0 group-hover:opacity-100 text-primary-500 hover:text-primary-600 transition-opacity",y.innerHTML="#",y.setAttribute("aria-label",`链接到 ${c.text}`),s.appendChild(y)}}),w(),window.addEventListener("scroll",v),window.location.hash){const l=window.location.hash.slice(1);setTimeout(()=>M(l),100)}},100)}),P(()=>{window.removeEventListener("scroll",v)}),(a,l)=>u.value.length>0?(n(),m("div",q,[t("nav",K,[(n(!0),m(T,null,B(u.value,s=>(n(),m("a",{key:s.id,href:`#${s.id}`,class:Q(["block py-1 text-sm transition-colors duration-200",s.level===1?"font-semibold text-gray-900 dark:text-white":s.level===2?"pl-3 font-medium text-gray-700 dark:text-gray-300":"pl-6 text-gray-600 dark:text-gray-400",I.value===s.id?"text-primary-600 dark:text-primary-400":"hover:text-primary-600 dark:hover:text-primary-400"]),onClick:x=>M(s.id)},g(s.text),11,X))),128))])])):(n(),m("div",tt," 此文章暂无目录 "))}}),ot=Y(et,[["__scopeId","data-v-9c2ab096"]]),rt={key:0,class:"min-h-screen bg-gray-50 dark:bg-gray-900"},st={class:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700"},at={class:"container-custom py-12"},it={class:"mb-6"},nt={class:"max-w-4xl mx-auto text-center"},lt={class:"mb-6"},ct={class:"text-3xl md:text-5xl font-bold text-gray-900 dark:text-white mb-6 leading-tight"},dt={class:"text-xl text-gray-600 dark:text-gray-400 mb-8"},gt={class:"flex flex-wrap items-center justify-center gap-6 text-gray-500 dark:text-gray-400"},mt={class:"flex items-center"},ut=["alt"],xt={class:"flex items-center"},pt=["datetime"],yt={class:"flex items-center"},ht={class:"container-custom py-8"},vt={class:"flex flex-col lg:flex-row gap-8"},ft={class:"flex-1"},bt={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden"},_t={key:0,class:"aspect-video overflow-hidden"},wt=["src","alt"],kt={class:"p-8"},It=["innerHTML"],Mt={class:"mt-12 pt-8 border-t border-gray-200 dark:border-gray-700"},jt={class:"flex flex-wrap gap-2"},Ct={class:"mt-8 pt-8 border-t border-gray-200 dark:border-gray-700"},Tt={class:"flex space-x-4"},Bt={class:"lg:w-80"},$t={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 mb-6 sticky top-24"},Dt={key:0,class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6"},Et={class:"space-y-4"},Ht={class:"flex space-x-3"},Nt=["src","alt"],zt={class:"flex-1 min-w-0"},At={class:"text-sm font-medium text-gray-900 dark:text-white group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors line-clamp-2"},Zt={class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},Gt={key:0,class:"bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700"},Rt={class:"container-custom py-8"},Lt={class:"flex justify-between"},Pt={class:"flex-1"},Qt={class:"flex items-center"},St={class:"text-lg font-medium text-gray-900 dark:text-white group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors"},Wt={class:"flex-1 text-right"},Ut={class:"flex items-center"},Vt={class:"text-lg font-medium text-gray-900 dark:text-white group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors"},Yt={key:1,class:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center"},Jt={class:"text-center"},z="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDQwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI0MDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik0xNzUgNzVIMjI1VjEyNUgxNzVWNzVaIiBmaWxsPSIjOUI5QkEzIi8+CjxwYXRoIGQ9Ik0xNTAgMTAwSDI1MFYxMTBIMTUwVjEwMFoiIGZpbGw9IiM5QjlCQTMiLz4KPHBhdGggZD0iTTE2MCAxMjBIMjQwVjEzMEgxNjBWMTIwWiIgZmlsbD0iIzlCOUJBMyIvPgo8L3N2Zz4=",Xt=A({__name:"ArticleDetail",setup($){const C=S(),I=U(),u=J(),o=_(()=>{const r=C.params.id;return u.getArticleById(r)}),M=_(()=>o.value?O(o.value.content):""),w=_(()=>o.value?u.getRelatedArticles(o.value.id,3):[]),v=_(()=>{if(!o.value)return null;const r=u.articles,e=r.findIndex(i=>i.id===o.value.id);return e>0?r[e-1]:null}),a=_(()=>{if(!o.value)return null;const r=u.articles,e=r.findIndex(i=>i.id===o.value.id);return e<r.length-1?r[e+1]:null}),l=r=>{const e=u.categories.find(i=>i.id===r);return(e==null?void 0:e.name)||r},s=()=>{I.back()},x=()=>{if(!o.value)return;const r=encodeURIComponent(window.location.href),e=encodeURIComponent(`${o.value.title} - ${o.value.excerpt}`);window.open(`https://twitter.com/intent/tweet?url=${r}&text=${e}`,"_blank")},c=()=>{if(!o.value)return;const r=encodeURIComponent(window.location.href),e=encodeURIComponent(o.value.title);window.open(`https://service.weibo.com/share/share.php?url=${r}&title=${e}`,"_blank")},y=async()=>{await F(window.location.href)&&alert("链接已复制到剪贴板")},D=r=>{const e=r.target;e.src=z},G=r=>{const e=r.target;e.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiBmaWxsPSIjRjNGNEY2Ii8+CjxjaXJjbGUgY3g9IjE2IiBjeT0iMTIiIHI9IjQiIGZpbGw9IiM5QjlCQTMiLz4KPHBhdGggZD0iTTggMjRDMTAgMjIgMTMgMjIgMTYgMjJDMTkgMjIgMjIgMjIgMjQgMjRIOFoiIGZpbGw9IiM5QjlCQTMiLz4KPC9zdmc+"};return W(o,r=>{if(r){document.title=`${r.title} - 个人技术博客`;const e=document.querySelector('meta[name="description"]');e&&e.setAttribute("content",r.excerpt)}},{immediate:!0}),Z(()=>{window.scrollTo({top:0,behavior:"smooth"})}),(r,e)=>{const i=E("font-awesome-icon"),f=E("router-link");return o.value?(n(),m("div",rt,[t("header",st,[t("div",at,[t("div",it,[t("button",{onClick:s,class:"inline-flex items-center text-gray-600 dark:text-gray-400 hover:text-primary-600 dark:hover:text-primary-400 transition-colors"},[d(i,{icon:"arrow-left",class:"mr-2"}),e[0]||(e[0]=h(" 返回文章列表 ",-1))])]),t("div",nt,[t("div",lt,[d(f,{to:`/category/${o.value.category}`,class:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-primary-100 dark:bg-primary-900/20 text-primary-800 dark:text-primary-200 hover:bg-primary-200 dark:hover:bg-primary-900/30 transition-colors"},{default:b(()=>[h(g(l(o.value.category)),1)]),_:1},8,["to"])]),t("h1",ct,g(o.value.title),1),t("p",dt,g(o.value.excerpt),1),t("div",gt,[t("div",mt,[t("img",{src:R,alt:o.value.author,class:"w-8 h-8 rounded-full mr-3",onError:G},null,40,ut),t("span",null,g(o.value.author),1)]),t("div",xt,[d(i,{icon:"calendar",class:"mr-2"}),t("time",{datetime:o.value.date},g(H(N)(o.value.date,"full")),9,pt)]),t("div",yt,[d(i,{icon:"clock",class:"mr-2"}),h(" "+g(o.value.readTime)+" 分钟阅读 ",1)])])])])]),t("div",ht,[t("div",vt,[t("main",ft,[t("article",bt,[o.value.coverImage?(n(),m("div",_t,[t("img",{src:o.value.coverImage,alt:o.value.title,class:"w-full h-full object-cover",onError:D},null,40,wt)])):k("",!0),t("div",kt,[t("div",{class:"article-content prose prose-lg dark:prose-invert max-w-none",innerHTML:M.value},null,8,It),t("div",Mt,[e[1]||(e[1]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"}," 文章标签 ",-1)),t("div",jt,[(n(!0),m(T,null,B(o.value.tags,p=>(n(),j(f,{key:p,to:`/tag/${p}`,class:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-primary-100 dark:hover:bg-primary-900/20 hover:text-primary-700 dark:hover:text-primary-300 transition-colors"},{default:b(()=>[d(i,{icon:"tag",class:"mr-1"}),h(" "+g(p),1)]),_:2},1032,["to"]))),128))])]),t("div",Ct,[e[5]||(e[5]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"}," 分享文章 ",-1)),t("div",Tt,[t("button",{onClick:x,class:"inline-flex items-center px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors"},[d(i,{icon:["fab","twitter"],class:"mr-2"}),e[2]||(e[2]=h(" Twitter ",-1))]),t("button",{onClick:c,class:"inline-flex items-center px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors"},[d(i,{icon:["fab","weibo"],class:"mr-2"}),e[3]||(e[3]=h(" 微博 ",-1))]),t("button",{onClick:y,class:"inline-flex items-center px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors"},[d(i,{icon:"link",class:"mr-2"}),e[4]||(e[4]=h(" 复制链接 ",-1))])])])])])]),t("aside",Bt,[t("div",$t,[e[6]||(e[6]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"}," 文章目录 ",-1)),d(ot,{content:o.value.content},null,8,["content"])]),w.value.length>0?(n(),m("div",Dt,[e[7]||(e[7]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"}," 相关文章 ",-1)),t("div",Et,[(n(!0),m(T,null,B(w.value,p=>(n(),j(f,{key:p.id,to:`/articles/${p.id}`,class:"block group"},{default:b(()=>[t("div",Ht,[t("img",{src:p.coverImage||z,alt:p.title,class:"w-16 h-16 object-cover rounded-lg flex-shrink-0",onError:D},null,40,Nt),t("div",zt,[t("h4",At,g(p.title),1),t("p",Zt,g(H(N)(p.date,"short")),1)])])]),_:2},1032,["to"]))),128))])])):k("",!0)])])]),v.value||a.value?(n(),m("nav",Gt,[t("div",Rt,[t("div",Lt,[t("div",Pt,[v.value?(n(),j(f,{key:0,to:`/articles/${v.value.id}`,class:"group flex items-center text-left"},{default:b(()=>[t("div",Qt,[d(i,{icon:"arrow-left",class:"mr-3 text-gray-400 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors"}),t("div",null,[e[8]||(e[8]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"上一篇",-1)),t("p",St,g(v.value.title),1)])])]),_:1},8,["to"])):k("",!0)]),t("div",Wt,[a.value?(n(),j(f,{key:0,to:`/articles/${a.value.id}`,class:"group flex items-center justify-end text-right"},{default:b(()=>[t("div",Ut,[t("div",null,[e[9]||(e[9]=t("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"下一篇",-1)),t("p",Vt,g(a.value.title),1)]),d(i,{icon:"arrow-right",class:"ml-3 text-gray-400 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors"})])]),_:1},8,["to"])):k("",!0)])])])])):k("",!0)])):(n(),m("div",Yt,[t("div",Jt,[d(i,{icon:"search",class:"text-6xl text-gray-300 dark:text-gray-600 mb-6"}),e[11]||(e[11]=t("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white mb-4"}," 文章未找到 ",-1)),e[12]||(e[12]=t("p",{class:"text-gray-600 dark:text-gray-400 mb-8"}," 抱歉，您访问的文章不存在或已被删除。 ",-1)),d(f,{to:"/articles",class:"btn btn-primary"},{default:b(()=>[...e[10]||(e[10]=[h(" 返回文章列表 ",-1)])]),_:1})])]))}}});export{Xt as default};
